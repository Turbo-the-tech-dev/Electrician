import React, { useState } from 'react';

const defaultCards = [
  { id: 1, question: "What is the capital of France?", answer: "Paris" },
  { id: 2, question: "What year did World War II end?", answer: "1945" },
  { id: 3, question: "What is the chemical symbol for gold?", answer: "Au" },
  { id: 4, question: "Who wrote 'Romeo and Juliet'?", answer: "William Shakespeare" },
  { id: 5, question: "What is the largest planet in our solar system?", answer: "Jupiter" },
];

export default function FlashcardApp() {
  const [cards, setCards] = useState(defaultCards);
  const [currentIndex, setCurrentIndex] = useState(0);
  const [isFlipped, setIsFlipped] = useState(false);
  const [showAddForm, setShowAddForm] = useState(false);
  const [newQuestion, setNewQuestion] = useState('');
  const [newAnswer, setNewAnswer] = useState('');
  const [isShuffled, setIsShuffled] = useState(false);

  const currentCard = cards[currentIndex];

  const handleFlip = () => {
    setIsFlipped(!isFlipped);
  };

  const handleNext = () => {
    setIsFlipped(false);
    setTimeout(() => {
      setCurrentIndex((prev) => (prev + 1) % cards.length);
    }, 150);
  };

  const handlePrev = () => {
    setIsFlipped(false);
    setTimeout(() => {
      setCurrentIndex((prev) => (prev - 1 + cards.length) % cards.length);
    }, 150);
  };

  const handleShuffle = () => {
    const shuffled = [...cards].sort(() => Math.random() - 0.5);
    setCards(shuffled);
    setCurrentIndex(0);
    setIsFlipped(false);
    setIsShuffled(true);
    setTimeout(() => setIsShuffled(false), 500);
  };

  const handleAddCard = () => {
    if (newQuestion.trim() && newAnswer.trim()) {
      const newCard = {
        id: Date.now(),
        question: newQuestion.trim(),
        answer: newAnswer.trim(),
      };
      setCards([...cards, newCard]);
      setNewQuestion('');
      setNewAnswer('');
      setShowAddForm(false);
    }
  };

  const handleDeleteCard = () => {
    if (cards.length > 1) {
      const newCards = cards.filter((_, index) => index !== currentIndex);
      setCards(newCards);
      setCurrentIndex((prev) => Math.min(prev, newCards.length - 1));
      setIsFlipped(false);
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 p-6 flex flex-col items-center justify-center">
      <h1 className="text-3xl font-bold text-white mb-2">Flashcard Study</h1>
      <p className="text-purple-200 mb-6">Card {currentIndex + 1} of {cards.length}</p>

      {/* Flashcard */}
      <div 
        className="perspective-1000 w-full max-w-md h-64 cursor-pointer mb-6"
        onClick={handleFlip}
      >
        <div 
          className={`relative w-full h-full transition-transform duration-500 transform-style-preserve-3d ${
            isFlipped ? 'rotate-y-180' : ''
          }`}
          style={{
            transformStyle: 'preserve-3d',
            transform: isFlipped ? 'rotateY(180deg)' : 'rotateY(0deg)',
          }}
        >
          {/* Front - Question */}
          <div 
            className="absolute w-full h-full bg-white rounded-2xl shadow-2xl flex flex-col items-center justify-center p-6 backface-hidden"
            style={{ backfaceVisibility: 'hidden' }}
          >
            <span className="text-xs uppercase tracking-wider text-indigo-400 font-semibold mb-3">Question</span>
            <p className="text-xl text-gray-800 text-center font-medium">{currentCard?.question}</p>
            <span className="text-xs text-gray-400 mt-4">Click to reveal answer</span>
          </div>

          {/* Back - Answer */}
          <div 
            className="absolute w-full h-full bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl shadow-2xl flex flex-col items-center justify-center p-6"
            style={{ 
              backfaceVisibility: 'hidden',
              transform: 'rotateY(180deg)',
            }}
          >
            <span className="text-xs uppercase tracking-wider text-indigo-200 font-semibold mb-3">Answer</span>
            <p className="text-xl text-white text-center font-medium">{currentCard?.answer}</p>
            <span className="text-xs text-indigo-200 mt-4">Click to see question</span>
          </div>
        </div>
      </div>

      {/* Navigation Controls */}
      <div className="flex items-center gap-4 mb-6">
        <button
          onClick={handlePrev}
          className="px-5 py-2.5 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors backdrop-blur-sm"
        >
          ‚Üê Previous
        </button>
        <button
          onClick={handleShuffle}
          className={`px-5 py-2.5 bg-yellow-500 hover:bg-yellow-400 text-gray-900 font-semibold rounded-lg transition-all ${
            isShuffled ? 'scale-95' : ''
          }`}
        >
          üîÄ Shuffle
        </button>
        <button
          onClick={handleNext}
          className="px-5 py-2.5 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors backdrop-blur-sm"
        >
          Next ‚Üí
        </button>
      </div>

      {/* Action Buttons */}
      <div className="flex gap-3 mb-6">
        <button
          onClick={() => setShowAddForm(!showAddForm)}
          className="px-4 py-2 bg-green-500 hover:bg-green-400 text-white rounded-lg transition-colors"
        >
          + Add Card
        </button>
        <button
          onClick={handleDeleteCard}
          disabled={cards.length <= 1}
          className="px-4 py-2 bg-red-500 hover:bg-red-400 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Delete Card
        </button>
      </div>

      {/* Add Card Form */}
      {showAddForm && (
        <div className="w-full max-w-md bg-white/10 backdrop-blur-md rounded-xl p-5 mb-4">
          <h3 className="text-white font-semibold mb-3">Add New Flashcard</h3>
          <input
            type="text"
            placeholder="Enter question..."
            value={newQuestion}
            onChange={(e) => setNewQuestion(e.target.value)}
            className="w-full px-4 py-2 rounded-lg bg-white/90 text-gray-800 placeholder-gray-500 mb-3 focus:outline-none focus:ring-2 focus:ring-purple-400"
          />
          <input
            type="text"
            placeholder="Enter answer..."
            value={newAnswer}
            onChange={(e) => setNewAnswer(e.target.value)}
            className="w-full px-4 py-2 rounded-lg bg-white/90 text-gray-800 placeholder-gray-500 mb-3 focus:outline-none focus:ring-2 focus:ring-purple-400"
          />
          <div className="flex gap-2">
            <button
              onClick={handleAddCard}
              className="flex-1 px-4 py-2 bg-green-500 hover:bg-green-400 text-white rounded-lg transition-colors"
            >
              Save Card
            </button>
            <button
              onClick={() => {
                setShowAddForm(false);
                setNewQuestion('');
                setNewAnswer('');
              }}
              className="px-4 py-2 bg-gray-500 hover:bg-gray-400 text-white rounded-lg transition-colors"
            >
              Cancel
            </button>
          </div>
        </div>
      )}

      {/* Progress Dots */}
      <div className="flex gap-1.5 flex-wrap justify-center max-w-md">
        {cards.map((_, index) => (
          <button
            key={index}
            onClick={() => {
              setCurrentIndex(index);
              setIsFlipped(false);
            }}
            className={`w-2.5 h-2.5 rounded-full transition-all ${
              index === currentIndex 
                ? 'bg-white scale-125' 
                : 'bg-white/30 hover:bg-white/50'
            }`}
          />
        ))}
      </div>

      <p className="text-purple-200/60 text-sm mt-6">
        Press cards to flip ‚Ä¢ Use arrows to navigate
      </p>
    </div>
  );
}
